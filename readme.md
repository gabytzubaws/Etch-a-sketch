It is not perfect but I've been trying to figure out what is wrong with it for three hours and it turned out to be a 'for' statement and I need a break.
